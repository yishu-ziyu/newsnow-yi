"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = _default;var _nodeProcess = _interopRequireDefault(await jitiImport("node:process"));
var _nodePath = await jitiImport("node:path");
var _vitePluginWithNitro = _interopRequireDefault(await jitiImport("vite-plugin-with-nitro"));
var _rollupGlob = await jitiImport("./tools/rollup-glob");
var _dir = await jitiImport("./shared/dir");function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

const nitroOption = {
  experimental: {
    database: true
  },
  rollupConfig: {
    plugins: [(0, _rollupGlob.RollopGlob)()]
  },
  sourceMap: false,
  database: {
    default: {
      connector: "better-sqlite3"
    }
  },
  devDatabase: {
    default: {
      connector: "better-sqlite3"
    }
  },
  imports: {
    dirs: ["server/utils", "shared"]
  },
  preset: "node-server",
  alias: {
    "@shared": (0, _nodePath.join)(_dir.projectDir, "shared"),
    "#": (0, _nodePath.join)(_dir.projectDir, "server")
  }
};

if (_nodeProcess.default.env.VERCEL) {
  nitroOption.preset = "vercel-edge";
  // You can use other online database, do it yourself. For more info: https://db0.unjs.io/connectors
  nitroOption.database = undefined;
  // nitroOption.vercel = {
  //   config: {
  //     cache: []
  //   },
  // }
} else if (_nodeProcess.default.env.CF_PAGES) {
  nitroOption.preset = "cloudflare-pages";
  nitroOption.unenv = {
    alias: {
      "safer-buffer": "node:buffer"
    }
  };
  nitroOption.database = {
    default: {
      connector: "cloudflare-d1",
      options: {
        bindingName: "NEWSNOW_DB"
      }
    }
  };
} else if (_nodeProcess.default.env.BUN) {
  nitroOption.preset = "bun";
  nitroOption.database = {
    default: {
      connector: "bun-sqlite"
    }
  };
}

function _default() {
  return (0, _vitePluginWithNitro.default)(nitroOption);
} /* v9-6b81dbc02a0ce4ea */
